# TELEGRAM_CONFIGS Environment Variable Example

## Cloudflare Workers Configuration

The `TELEGRAM_CONFIGS` environment variable should contain a JSON array of project configurations.

### Example Configuration:

```json
[
  {
    "id": "project-1",
    "botToken": "1234567890:ABCdefGHIjklMNOpqrsTUVwxyz",
    "channelId": "@my_channel"
  },
  {
    "id": "project-2",
    "botToken": "9876543210:XYZwvuTSRqponMLKjiHGFedcba",
    "channelId": "-1001234567890"
  }
]
```

---

## Setup Instructions

### 1. Create a Telegram Bot

1. Open Telegram and search for [@BotFather](https://t.me/BotFather)
2. Send `/newbot` command
3. Follow the instructions to create your bot
4. Save the bot token provided

### 2. Get Channel ID

**Method 1: For public channels**
- Use the channel username: `@your_channel`

**Method 2: For private channels**
- Add [@userinfobot](https://t.me/userinfobot) to your channel
- Forward any message from the channel to the bot
- The bot will reply with the channel ID (e.g., `-1001234567890`)

### 3. Add Bot to Channel

1. Open your Telegram channel
2. Go to channel settings â†’ Administrators
3. Add your bot as administrator
4. Grant permission to post messages

### 4. Set Environment Variable in Cloudflare

1. Go to Cloudflare Workers dashboard
2. Select your worker
3. Navigate to **Settings** â†’ **Variables**
4. Add new variable:
   - **Name**: `TELEGRAM_CONFIGS`
   - **Value**: Your JSON configuration (minified, on one line)
   - **Type**: Text (not encrypted)

**Example (single line):**
```
[{"id":"project-1","botToken":"1234567890:ABCdefGHIjklMNOpqrsTUVwxyz","channelId":"@my_channel"},{"id":"project-2","botToken":"9876543210:XYZwvuTSRqponMLKjiHGFedcba","channelId":"-1001234567890"}]
```

---

## Deployment

### Install dependencies:
```bash
npm install
```

### Deploy to Cloudflare:
```bash
npm run deploy
```

Or login first:
```bash
npx wrangler login
npm run deploy
```

### Local Development:
```bash
npm run dev
```

---

## API Usage

### Endpoint

```
POST https://your-worker.your-subdomain.workers.dev/
```

### Request Body

```json
{
  "projectId": "project-1",
  "message": "Hello from Cloudflare!",
  "files": [
    {
      "filename": "report.pdf",
      "content": "base64_encoded_file_content_here",
      "mimeType": "application/pdf"
    }
  ]
}
```

### Example: Send Message Only

```bash
curl -X POST https://your-worker.your-subdomain.workers.dev/ \
  -H "Content-Type: application/json" \
  -d '{
    "projectId": "project-1",
    "message": "Deployment successful! ðŸš€"
  }'
```

### Example: JavaScript/TypeScript

```javascript
const sendToTelegram = async (projectId, message, files = []) => {
  const response = await fetch('https://your-worker.your-subdomain.workers.dev/', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      projectId,
      message,
      files
    })
  });
  return response.json();
};

// Usage
await sendToTelegram('project-1', 'Hello!', [
  {
    filename: 'data.txt',
    content: btoa('file content')
  }
]);
```

### Example: Python

```python
import requests
import base64

def send_to_telegram(project_id, message, file_path=None):
    data = {
        "projectId": project_id,
        "message": message
    }
    
    if file_path:
        with open(file_path, 'rb') as f:
            content = base64.b64encode(f.read()).decode()
            data['files'] = [{
                'filename': os.path.basename(file_path),
                'content': content
            }]
    
    response = requests.post(
        'https://your-worker.your-subdomain.workers.dev/',
        json=data
    )
    return response.json()
```

---

## Security Notes

- Keep your bot tokens secure
- Never commit tokens to version control
- Use Cloudflare environment variables for sensitive data
- Consider adding authentication to your Worker if needed (API keys, JWT, etc.)
